
set(TEST_REF_DIR ${CMAKE_CURRENT_SOURCE_DIR}/reference)
set(TEST_INP_DIR ${CMAKE_CURRENT_SOURCE_DIR}/input)
set(TEST_OUT_DIR ${CMAKE_CURRENT_BINARY_DIR}/test_output)

add_custom_target(build-test-dir ALL
    COMMAND ${CMAKE_COMMAND} -E make_directory ${TEST_OUT_DIR})

function(add_reg_test reg_file)
  string(REPLACE ".txt" "" test_name ${reg_file})
  string(REPLACE "_Registry" "" test_name ${test_name})
  add_test(NAME ${test_name} COMMAND openfast_registry_cpp -O ${TEST_OUT_DIR} -I ${TEST_INP_DIR}
            ${TEST_INP_DIR}/${reg_file} ${ARGN})
endfunction()

add_reg_test(AeroAcoustics_Registry.txt -noextrap)
add_reg_test(AeroDyn_Driver_Registry.txt -noextrap)
add_reg_test(AeroDyn_Inflow_Registry.txt -noextrap)
add_reg_test(AeroDyn_Registry.txt)
add_reg_test(AirfoilInfo_Registry.txt -noextrap)
add_reg_test(AWAE_Registry.txt -noextrap)
add_reg_test(BeamDyn_Registry.txt)
add_reg_test(BEMT_Registry.txt)
add_reg_test(Conv_Radiation.txt)
add_reg_test(Current.txt)
add_reg_test(DBEMT_Registry.txt)
add_reg_test(ElastoDyn_Registry.txt)
add_reg_test(ExtPtfm_MCKF_Registry.txt)
add_reg_test(FAST_Farm_Registry.txt -noextrap)
add_reg_test(FAST_Registry.txt -noextrap)
add_reg_test(FASTWrapper_Registry.txt -noextrap)
add_reg_test(FEAM_Registry.txt)
add_reg_test(FVW_Registry.txt)
add_reg_test(HydroDyn.txt)
add_reg_test(IfW_4Dext.txt -noextrap)
add_reg_test(IfW_BladedFFWind.txt -noextrap)
add_reg_test(IfW_FFWind_Base.txt -noextrap)
add_reg_test(IfW_HAWCWind.txt -noextrap)
add_reg_test(IfW_TSFFWind.txt -noextrap)
add_reg_test(IfW_UniformWind.txt -noextrap)
add_reg_test(IfW_UserWind.txt -noextrap)
add_reg_test(InflowWind.txt)
add_reg_test(IceFloe_FASTRegistry.inp)
add_reg_test(Lidar.txt)
add_reg_test(MAP_Fortran_Registry.txt -noextrap)
add_reg_test(MAP_Registry.txt -ccode)
add_reg_test(MoorDyn_Registry.txt)
add_reg_test(Morison.txt)
add_reg_test(OpenFOAM_Registry.txt -ccode)
add_reg_test(OrcaFlexInterface.txt)
add_reg_test(Registry_BeamDyn.txt)
add_reg_test(Registry_IceDyn.txt)
add_reg_test(SC_DataEx_Registry.txt -ccode -noextrap)
add_reg_test(ServoDyn_Registry.txt)
add_reg_test(SS_Excitation.txt)
add_reg_test(SS_Radiation.txt)
add_reg_test(StrucCtrl_Registry.txt)
add_reg_test(SubDyn_Registry.txt)
add_reg_test(SuperController_Registry.txt -ccode)
add_reg_test(UnsteadyAero_Registry.txt)
add_reg_test(WakeDynamics_Registry.txt -noextrap)
add_reg_test(WAMIT.txt)
add_reg_test(WAMIT2.txt)
add_reg_test(Waves.txt)
add_reg_test(Waves2.txt)